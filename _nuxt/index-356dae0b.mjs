import O from"./RecordingButton-d5418a9f.mjs";import A from"./ShowStatsButton-c5631d1d.mjs";import J from"./ContainerUi-d7551460.mjs";import N from"./OperationHistoryPanel-261422da.mjs";import{p as F,a as I,A as K,e as T,b as B,a4 as E,x as U,a3 as l,f as $,o as M,i as R,j as u,k as i,u as f,C as q}from"./entry-3e2f788a.mjs";import{u as z}from"./useOperation-1f5d67e0.mjs";import{u as V}from"./useKeyboard-58b0ab5d.mjs";import{u as D}from"./useUpdate-4fa1fc2f.mjs";import H from"./ButtonMenu-6c48e3a0.mjs";import L from"./SettingsButton-d5cda761.mjs";import"./Recorder-66683fc3.mjs";import"./RecordingModal-afc22c2d.mjs";import"./VButton-5f5207fd.mjs";import"./VModal-788c9a77.mjs";import"./VIcons-a38e90bb.mjs";import"./mdi-4cca1244.mjs";import"./PanelUi-dce00041.mjs";import"./LayoutChangeArea-cb795950.mjs";import"./useDragAndDrop-5f1fa50d.mjs";import"./RectUi-ff27ac72.mjs";import"./onDragStart-b67a33ef.mjs";import"./ResizeTop-b3ded944.mjs";import"./ResizeLeft-8b915bf5.mjs";import"./SettingsModal-ede619b7.mjs";import"./VNumberInput-f7367b29.mjs";import"./VInputBase-76e3d3d3.mjs";const X={style:{height:"calc(100vh - 48px)"}},G={class:"header-menu"},P=I({__name:"index",setup(Q){const{container:r,setContainer:a}=K(),{init:d,timeline:_,setTimeline:c}=T(),{assets:y,setAssets:m}=B(),v=z(),{init:h}=V(),{update:g}=D(),x=E();U(async()=>{h();const t=localStorage.getItem("save");if(t===null&&x.query.demo==="true"){const e=await(await fetch("/vega/demo/project.json")).text(),s=JSON.parse(e);m(s.assets),c(s.timeline),a(s.container)}else if(typeof t=="string"){const e=JSON.parse(t);m(e.assets),c(e.timeline),a(e.container)}let o=0;const n=e=>{g(e-o),requestAnimationFrame(n),o=e};n(0),window.addEventListener("keydown",e=>{const s=j()?e.metaKey:e.ctrlKey;e.keyCode===90&&e.shiftKey&&s?l.redo():e.keyCode===90&&s&&l.undo(),e.keyCode===83&&s&&(localStorage.setItem("save",p()),v.pushHistory("Save"),e.preventDefault())}),d()});function j(){return navigator.platform.toUpperCase().includes("MAC")}function k(){const t=document.createElement("input");t.type="file",t.accept=".json",t.click(),t.onchange=()=>{if(!t.files)return;const o=t.files[0];if(!o)return;const n=new FileReader;n.onload=()=>{typeof n.result=="string"&&S(n.result)},n.readAsText(o)}}function C(){const t=p(),o=document.createElement("a");o.href="data:text/json;charset=utf-8,"+encodeURIComponent(t),o.download="project.json",o.click()}function p(){const t={container:r.value,timeline:_.value,assets:y.value};return JSON.stringify(t)}function S(t){const o=JSON.parse(t);return a(o.container),c(o.timeline),m(o.assets),o}const w=$(()=>r.value);return(t,o)=>{const n=O,e=A,s=J,b=N;return M(),R("div",{class:"root text-white bg-background1",style:q({display:f(r).align==="horizontal"?"flex":"block"})},[u("div",X,[u("div",G,[i(n),i(H,{label:"File",items:[{name:"Open",onClick:k},{name:"Save",onClick:C}]},null,8,["items"]),i(L),i(e)]),i(s,{container:f(w)},null,8,["container"]),i(b)])],4)}}});var Ce=F(P,[["__scopeId","data-v-58910a4b"]]);export{Ce as default};
