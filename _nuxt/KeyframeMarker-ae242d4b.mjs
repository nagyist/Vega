import{a as E,s as b}from"./useTimeline-80d07c57.mjs";import{u as g}from"./useKeyboard-f4963c17.mjs";import{o as M}from"./onDragStart-b67a33ef.mjs";import{k as $,a as B,b as f,r as L,o as u,f as p,X as Z,u as _,I as h,Z as z,$ as A,h as D}from"./entry-29da48b6.mjs";const H=a=>(z("data-v-9b7148be"),a=a(),A(),a),T=["id"],F=H(()=>D("path",{d:"M12 2C11.5 2 11 2.19 10.59 2.59L2.59 10.59C1.8 11.37 1.8 12.63 2.59 13.41L10.59 21.41C11.37 22.2 12.63 22.2 13.41 21.41L21.41 13.41C22.2 12.63 22.2 11.37 21.41 10.59L13.41 2.59C13 2.19 12.5 2 12 2Z"},null,-1)),G=[F],N=B({__name:"KeyframeMarker",props:{animation:null,scale:null,left:null,stripId:null,effect:null},setup(a){const t=a,{timeline:o,selectKeyframe:r,updateEffect:v,getFisrtSelectedStrip:y}=E(),S=24,s=12,x=f(()=>({top:`${S/2-s/2}px`,left:`${t.left+t.animation.time*t.scale-s/2}px`})),I=f(()=>o.value.selectedKeyframes.includes(t.animation)),n=L(!1);function k(){n.value&&r([t.animation]),n.value=!1}function K(c){c.stopPropagation(),n.value=!0;const l=t.animation.time;M(c,(P,V,w)=>{if(!t.effect||(n.value=!1,o.value.selectedKeyframes.find(e=>e.id===t.animation.id)||r([t.animation]),!y()))return;const d=o.value.selectedKeyframes.filter(e=>e.id!==t.animation.id).map(e=>e.id),i={...t.effect,animations:t.effect.animations.map(e=>({...e}))};i.animations.forEach(e=>{(e.id===t.animation.id||d.includes(e.id))&&(e.time=b(l+w.x/t.scale))}),i.animations.sort((e,C)=>e.time-C.time),v(t.stripId,i);const m=[];i.animations.forEach(e=>{d.includes(e.id)&&m.push(e)}),r([i.animations.find(e=>e.id===t.animation.id),...m])})}return g(),(c,l)=>(u(),p("div",{id:a.animation.id,style:h(_(x)),class:"keyframe-marker cursor-pointer"},[(u(),p("svg",{class:Z(_(I)?"selected":""),style:h(`width: ${s}px; height: ${s}px`),viewBox:"0 0 24 24",onMouseup:k,onMousedown:K},G,38))],12,T))}});var Q=$(N,[["__scopeId","data-v-9b7148be"]]);export{Q as default};
